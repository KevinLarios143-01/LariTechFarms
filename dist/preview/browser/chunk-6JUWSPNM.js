import{a as D}from"./chunk-DFR7G4ST.js";import{$ as u,$c as v,G as n,I as $,K as d,X as _,_c as b,d as m,e as s,ea as U,ha as f,o as h,r as o}from"./chunk-AZAYKVK3.js";import{a as l,b as g}from"./chunk-REZWHGN7.js";var O=(()=>{let e=class e{constructor(t){this.http=t,this.apiUrl=`${D.apiUrl}/v1/usuarios`,this._loading$=new s(!0),this._search$=new m,this._userData$=new s([]),this._total$=new s(0),this._state={page:1,pageSize:10,searchTerm:"",sortColumn:"",sortDirection:""},this._search$.pipe(u(()=>this._loading$.next(!0)),$(200),_(()=>this._search()),d(200),u(()=>this._loading$.next(!1))).subscribe(a=>{this._userData$.next(a.userData),this._total$.next(a.total)}),this._search$.next()}get userData$(){return this._userData$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get page(){return this._state.page}get pageSize(){return this._state.pageSize}get searchTerm(){return this._state.searchTerm}getUserStats(){return this.http.get(`${this.apiUrl}/stats`).pipe(o(t=>(console.log("Stats API response:",t),t.data?.data?t.data.data:t.data?t.data:t)),n(t=>(console.error("Error fetching user stats:",t),h({totalUsuarios:0,usuariosActivos:0,usuariosInactivos:0,usuariosPorRol:[],usuariosNuevos:0}))))}set page(t){this._set({page:t})}set pageSize(t){this._set({pageSize:t})}set searchTerm(t){this._set({searchTerm:t})}set sortColumn(t){this._set({sortColumn:t})}set sortDirection(t){this._set({sortDirection:t})}_set(t){Object.assign(this._state,t),this._search$.next()}_search(){let{pageSize:t,page:a,searchTerm:p}=this._state,i=new b().set("page",a.toString()).set("limit",t.toString());return p&&(i=i.set("search",p)),this.http.get(this.apiUrl,{params:i}).pipe(o(c=>({userData:this.mapUsuarios(c.data.data),total:c.data.pagination.total})),n(()=>h({userData:[],total:0})))}mapUsuarios(t){return t.map(a=>g(l({},a),{img:"./assets/images/laritechfarms/2.jpg"}))}listarUsuarios(){return this.http.get(`${this.apiUrl}`)}crearUsuario(t){return this.http.post(`${this.apiUrl}`,t)}obtenerUsuario(t){return this.http.get(`${this.apiUrl}/${t}`)}actualizarUsuario(t,a){return this.http.put(`${this.apiUrl}/${t}`,a)}eliminarUsuario(t){return this.http.delete(`${this.apiUrl}/${t}`)}restablecerPassword(t){return this.http.patch(`${this.apiUrl}/${t}/reset-password`,{})}activateUsuario(t){return this.http.patch(`${this.apiUrl}/${t}/activate`,{})}deactivateUsuario(t){return this.http.patch(`${this.apiUrl}/${t}/deactivate`,{})}obtenerEstadisticas(){return this.http.get(`${this.apiUrl}/stats`)}};e.\u0275fac=function(a){return new(a||e)(f(v))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();export{O as a};
