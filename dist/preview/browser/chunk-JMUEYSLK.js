import{a as D}from"./chunk-IORNA22M.js";import{$ as n,G as p,I as m,K as _,X as U,Zc as f,_c as v,d as $,e as a,ea as d,ha as b,o as h,r as o}from"./chunk-KFCCYZAB.js";import{a as l,b as g}from"./chunk-REZWHGN7.js";var O=(()=>{let e=class e{constructor(t){this.http=t,this.apiUrl=`${D.apiUrl}/v1/usuarios`,this._loading$=new a(!0),this._search$=new $,this._userData$=new a([]),this._total$=new a(0),this._state={page:1,pageSize:10,searchTerm:"",sortColumn:"",sortDirection:""},this._search$.pipe(n(()=>this._loading$.next(!0)),m(200),U(()=>this._search()),_(200),n(()=>this._loading$.next(!1))).subscribe(s=>{this._userData$.next(s.userData),this._total$.next(s.total)}),this._search$.next()}get userData$(){return this._userData$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get page(){return this._state.page}get pageSize(){return this._state.pageSize}get searchTerm(){return this._state.searchTerm}getUserStats(){return this.http.get(`${this.apiUrl}/stats`).pipe(o(t=>t.data.data),p(()=>h({totalUsuarios:0,usuariosActivos:0,usuariosInactivos:0,usuariosPorRol:[],usuariosNuevos:0})))}set page(t){this._set({page:t})}set pageSize(t){this._set({pageSize:t})}set searchTerm(t){this._set({searchTerm:t})}set sortColumn(t){this._set({sortColumn:t})}set sortDirection(t){this._set({sortDirection:t})}_set(t){Object.assign(this._state,t),this._search$.next()}_search(){let{pageSize:t,page:s,searchTerm:u}=this._state,i=new f().set("page",s.toString()).set("limit",t.toString());return u&&(i=i.set("search",u)),this.http.get(this.apiUrl,{params:i}).pipe(o(c=>({userData:this.mapUsuarios(c.data.data),total:c.data.pagination.total})),p(()=>h({userData:[],total:0})))}mapUsuarios(t){return t.map(s=>g(l({},s),{img:"./assets/images/users/1.jpg"}))}listarUsuarios(){return this.http.get(`${this.apiUrl}`)}crearUsuario(t){return this.http.post(`${this.apiUrl}`,t)}obtenerUsuario(t){return this.http.get(`${this.apiUrl}/${t}`)}actualizarUsuario(t,s){return this.http.put(`${this.apiUrl}/${t}`,s)}eliminarUsuario(t){return this.http.delete(`${this.apiUrl}/${t}`)}restablecerPassword(t){return this.http.patch(`${this.apiUrl}/${t}/reset-password`,{})}activarUsuario(t){return this.http.patch(`${this.apiUrl}/${t}/activar`,{})}desactivarUsuario(t){return this.http.patch(`${this.apiUrl}/${t}/desactivar`,{})}obtenerEstadisticas(){return this.http.get(`${this.apiUrl}/stats`)}};e.\u0275fac=function(s){return new(s||e)(b(v))},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();export{O as a};
