import{a as X}from"./chunk-2X3FDDBP.js";import{a as W}from"./chunk-DPFT2ISI.js";import"./chunk-IORNA22M.js";import{c as K,n as Q}from"./chunk-ZNKMRUWH.js";import"./chunk-XG7TRELF.js";import"./chunk-B56AIWNQ.js";import{r as J}from"./chunk-3DATYCE5.js";import"./chunk-EMEDTLE5.js";import{c as O,e as p,g as j,h as M,m as P,p as D,q as V,r as R,s as H,t as $,w as B,y as z}from"./chunk-XRHNCSTF.js";import{Ib as y,Kb as b,Qa as a,Ra as f,Wb as n,Zb as L,db as u,dc as k,jb as h,kd as G,la as q,lb as g,nb as N,rb as m,ub as w,vb as I,wb as d,xb as i,yb as c}from"./chunk-AZAYKVK3.js";import"./chunk-REZWHGN7.js";var Y=(e,r)=>r.id;function Z(e,r){e&1&&n(0," El nombre es requerido ")}function ee(e,r){e&1&&n(0," El nombre debe tener al menos 2 caracteres ")}function te(e,r){if(e&1&&(d(0,"div",12),u(1,Z,1,0)(2,ee,1,0),i()),e&2){let s,t,l=b();a(),m(!((s=l.userForm.get("nombre"))==null||s.errors==null)&&s.errors.required?1:-1),a(),m(!((t=l.userForm.get("nombre"))==null||t.errors==null)&&t.errors.minlength?2:-1)}}function ie(e,r){e&1&&n(0," El apellido es requerido ")}function oe(e,r){e&1&&n(0," El apellido debe tener al menos 2 caracteres ")}function ne(e,r){if(e&1&&(d(0,"div",12),u(1,ie,1,0)(2,oe,1,0),i()),e&2){let s,t,l=b();a(),m(!((s=l.userForm.get("apellido"))==null||s.errors==null)&&s.errors.required?1:-1),a(),m(!((t=l.userForm.get("apellido"))==null||t.errors==null)&&t.errors.minlength?2:-1)}}function re(e,r){e&1&&n(0," El email es requerido ")}function le(e,r){e&1&&n(0," Ingrese un email v\xE1lido ")}function ae(e,r){if(e&1&&(d(0,"div",12),u(1,re,1,0)(2,le,1,0),i()),e&2){let s,t,l=b();a(),m(!((s=l.userForm.get("email"))==null||s.errors==null)&&s.errors.required?1:-1),a(),m(!((t=l.userForm.get("email"))==null||t.errors==null)&&t.errors.email?2:-1)}}function de(e,r){if(e&1&&(d(0,"option",20),n(1),i()),e&2){let s=r.$implicit;h("value",s.id),a(),L("",s.nombre," ",s.apellido,"")}}function se(e,r){e&1&&n(0," La contrase\xF1a es requerida ")}function me(e,r){e&1&&n(0," La contrase\xF1a debe tener al menos 6 caracteres ")}function ue(e,r){if(e&1&&(d(0,"div",12),u(1,se,1,0)(2,me,1,0),i()),e&2){let s,t,l=b();a(),m(!((s=l.userForm.get("password"))==null||s.errors==null)&&s.errors.required?1:-1),a(),m(!((t=l.userForm.get("password"))==null||t.errors==null)&&t.errors.minlength?2:-1)}}function pe(e,r){e&1&&(d(0,"div",12),n(1," Seleccione un rol "),i())}function ce(e,r){e&1&&(c(0,"span",33),n(1," Guardando... "))}function _e(e,r){e&1&&n(0," Guardar Usuario ")}var xe=(()=>{let r=class r{constructor(t,l,o,_,v){this.fb=t,this.router=l,this.usuarioService=o,this.empleadoService=_,this.toastr=v,this.isLoading=!1,this.empleados=[]}ngOnInit(){this.initForm(),this.loadEmpleados()}initForm(){this.userForm=this.fb.group({email:["",[p.required,p.email]],password:["",[p.required,p.minLength(6)]],nombre:["",[p.required,p.minLength(2)]],apellido:["",[p.required,p.minLength(2)]],rol:["",[p.required]],id_empleado:[null]})}onSubmit(){this.userForm.valid?(this.isLoading=!0,this.usuarioService.crearUsuario(this.userForm.value).subscribe({next:t=>{this.toastr.success("Usuario creado exitosamente","\xC9xito",{timeOut:3e3,positionClass:"toast-top-right"}),this.router.navigate(["/dashboard/hrmdashboards/users/user-list"])},error:t=>{console.error("Error al crear usuario:",t);let l="Error desconocido";t.error?.message?l=t.error.message:t.error?.error?l=t.error.error:t.message?l=t.message:typeof t.error=="string"&&(l=t.error),this.toastr.error("Error al crear usuario: "+l,"Error",{timeOut:3e3,positionClass:"toast-top-right"}),this.isLoading=!1}})):(this.toastr.warning("Por favor, complete todos los campos requeridos","Advertencia",{timeOut:3e3,positionClass:"toast-top-right"}),this.markFormGroupTouched())}markFormGroupTouched(){Object.keys(this.userForm.controls).forEach(t=>{this.userForm.get(t)?.markAsTouched()})}loadEmpleados(){this.empleadoService.getEmpleados().subscribe({next:t=>{this.empleados=t},error:t=>{console.error("Error al cargar empleados:",t),this.toastr.error("Error al cargar la lista de empleados","Error")}})}onCancel(){this.router.navigate(["/dashboard/hrmdashboards/users/user-list"])}};r.\u0275fac=function(l){return new(l||r)(f(B),f(G),f(X),f(W),f(J))},r.\u0275cmp=q({type:r,selectors:[["app-add-user"]],standalone:!0,features:[k],decls:73,vars:24,consts:[[3,"title","title2","class1","path"],[1,"row"],[1,"col-xl-12"],[1,"card","custom-card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"form-group","mb-3"],["for","nombre",1,"form-label"],["type","text","formControlName","nombre","placeholder","Ingrese el nombre",1,"form-control"],[1,"invalid-feedback","d-block"],["for","apellido",1,"form-label"],["type","text","formControlName","apellido","placeholder","Ingrese el apellido",1,"form-control"],["for","email",1,"form-label"],["type","email","formControlName","email","placeholder","usuario@ejemplo.com",1,"form-control"],["for","id_empleado",1,"form-label"],["formControlName","id_empleado",1,"form-control"],["value",""],[3,"value"],["for","password",1,"form-label"],["type","password","formControlName","password","placeholder","Ingrese la contrase\xF1a",1,"form-control"],["for","rol",1,"form-label"],["formControlName","rol",1,"form-control"],["value","superadmin"],["value","admin"],["value","gerente"],["value","supervisor"],["value","operador"],[1,"col-12"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(l,o){if(l&1&&(c(0,"app-hr-dashboard-page-header",0),d(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),n(6,"Informaci\xF3n del Usuario"),i()(),d(7,"div",6)(8,"form",7),y("ngSubmit",function(){return o.onSubmit()}),d(9,"div",1)(10,"div",8)(11,"div",9)(12,"label",10),n(13,"Nombre *"),i(),c(14,"input",11),u(15,te,3,2,"div",12),i()(),d(16,"div",8)(17,"div",9)(18,"label",13),n(19,"Apellido *"),i(),c(20,"input",14),u(21,ne,3,2,"div",12),i()()(),d(22,"div",1)(23,"div",8)(24,"div",9)(25,"label",15),n(26,"Email *"),i(),c(27,"input",16),u(28,ae,3,2,"div",12),i()(),d(29,"div",8)(30,"div",9)(31,"label",17),n(32,"Empleado"),i(),d(33,"select",18)(34,"option",19),n(35,"Seleccione un empleado (opcional)"),i(),w(36,de,2,3,"option",20,Y),i()()()(),d(38,"div",1)(39,"div",8)(40,"div",9)(41,"label",21),n(42,"Contrase\xF1a *"),i(),c(43,"input",22),u(44,ue,3,2,"div",12),i()(),c(45,"div",8),i(),d(46,"div",1)(47,"div",8)(48,"div",9)(49,"label",23),n(50,"Rol *"),i(),d(51,"select",24)(52,"option",19),n(53,"Seleccione un rol"),i(),d(54,"option",25),n(55,"Super Administrador"),i(),d(56,"option",26),n(57,"Administrador"),i(),d(58,"option",27),n(59,"Gerente"),i(),d(60,"option",28),n(61,"Supervisor"),i(),d(62,"option",29),n(63,"Operador"),i()(),u(64,pe,2,0,"div",12),i()(),c(65,"div",8),i(),d(66,"div",1)(67,"div",30)(68,"button",31),u(69,ce,2,0)(70,_e,1,0),i(),d(71,"button",32),y("click",function(){return o.onCancel()}),n(72," Cancelar "),i()()()()()()()()),l&2){let _,v,C,F,E,S,x,A,T,U;N("btn btn-secondary"),h("title","Agregar Usuario")("title2","Volver a Lista")("class1","")("path","/dashboard/hrmdashboards/users/user-list"),a(8),h("formGroup",o.userForm),a(6),g("is-invalid",((_=o.userForm.get("nombre"))==null?null:_.invalid)&&((_=o.userForm.get("nombre"))==null?null:_.touched)),a(),m((v=o.userForm.get("nombre"))!=null&&v.invalid&&((v=o.userForm.get("nombre"))!=null&&v.touched)?15:-1),a(5),g("is-invalid",((C=o.userForm.get("apellido"))==null?null:C.invalid)&&((C=o.userForm.get("apellido"))==null?null:C.touched)),a(),m((F=o.userForm.get("apellido"))!=null&&F.invalid&&((F=o.userForm.get("apellido"))!=null&&F.touched)?21:-1),a(6),g("is-invalid",((E=o.userForm.get("email"))==null?null:E.invalid)&&((E=o.userForm.get("email"))==null?null:E.touched)),a(),m((S=o.userForm.get("email"))!=null&&S.invalid&&((S=o.userForm.get("email"))!=null&&S.touched)?28:-1),a(8),I(o.empleados),a(7),g("is-invalid",((x=o.userForm.get("password"))==null?null:x.invalid)&&((x=o.userForm.get("password"))==null?null:x.touched)),a(),m((A=o.userForm.get("password"))!=null&&A.invalid&&((A=o.userForm.get("password"))!=null&&A.touched)?44:-1),a(7),g("is-invalid",((T=o.userForm.get("rol"))==null?null:T.invalid)&&((T=o.userForm.get("rol"))==null?null:T.touched)),a(13),m((U=o.userForm.get("rol"))!=null&&U.invalid&&((U=o.userForm.get("rol"))!=null&&U.touched)?64:-1),a(4),h("disabled",o.userForm.invalid||o.isLoading),a(),m(o.isLoading?69:70)}},dependencies:[Q,K,z,P,H,$,O,R,j,M,D,V]});let e=r;return e})();export{xe as AddUserComponent};
