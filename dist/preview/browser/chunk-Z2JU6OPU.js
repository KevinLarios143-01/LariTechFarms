import{a as B}from"./chunk-36PAIUO2.js";import{a as $}from"./chunk-ZHZ6JAOD.js";import"./chunk-IORNA22M.js";import{c as P,n as H}from"./chunk-XLGDB24R.js";import"./chunk-SNUM6ZIL.js";import"./chunk-HC3PXDFB.js";import{r as R}from"./chunk-GNT7AIZA.js";import"./chunk-5ILM3463.js";import{c as V,e as u,g as M,h as O,m as j,p as w,q as A,r as D,s as k,t as q,w as z,y as G}from"./chunk-MN5F6KP3.js";import{Cb as U,Ib as g,Kb as _,Qa as s,Ra as c,Wb as o,Zb as y,db as p,dc as I,id as N,jb as f,kd as L,la as C,nb as x,rb as v,ua as E,ub as S,va as b,vb as F,wb as i,xb as e,yb as h,yc as T}from"./chunk-W3KPMJ6O.js";import"./chunk-REZWHGN7.js";var W=(t,a)=>a.id;function X(t,a){t&1&&(i(0,"div",7)(1,"div",9)(2,"span",10),o(3,"Cargando..."),e()()())}function Y(t,a){t&1&&(i(0,"div",16),o(1," El nombre es requerido (m\xEDnimo 2 caracteres) "),e())}function Z(t,a){t&1&&(i(0,"div",16),o(1," El apellido es requerido (m\xEDnimo 2 caracteres) "),e())}function ee(t,a){t&1&&(i(0,"div",16),o(1," Ingrese un email v\xE1lido "),e())}function te(t,a){if(t&1&&(i(0,"option",21),o(1),e()),t&2){let d=a.$implicit;f("value",d.id),s(),y("",d.nombre," ",d.apellido,"")}}function ie(t,a){t&1&&(i(0,"div",16),o(1," Seleccione un rol "),e())}function oe(t,a){t&1&&(h(0,"span",31),o(1," Actualizando... "))}function re(t,a){t&1&&o(0," Actualizar Usuario ")}function ne(t,a){if(t&1){let d=U();i(0,"form",11),g("ngSubmit",function(){E(d);let n=_();return b(n.onSubmit())}),i(1,"div",1)(2,"div",12)(3,"div",13)(4,"label",14),o(5,"Nombre *"),e(),h(6,"input",15),p(7,Y,2,0,"div",16),e()(),i(8,"div",12)(9,"div",13)(10,"label",14),o(11,"Apellido *"),e(),h(12,"input",17),p(13,Z,2,0,"div",16),e()()(),i(14,"div",1)(15,"div",12)(16,"div",13)(17,"label",14),o(18,"Email *"),e(),h(19,"input",18),p(20,ee,2,0,"div",16),e()(),i(21,"div",12)(22,"div",13)(23,"label",14),o(24,"Empleado"),e(),i(25,"select",19)(26,"option",20),o(27,"Seleccione un empleado (opcional)"),e(),S(28,te,2,3,"option",21,W),e()()()(),i(30,"div",1)(31,"div",12)(32,"div",13)(33,"label",14),o(34,"Rol *"),e(),i(35,"select",22)(36,"option",20),o(37,"Seleccione un rol"),e(),i(38,"option",23),o(39,"Super Administrador"),e(),i(40,"option",24),o(41,"Administrador"),e(),i(42,"option",25),o(43,"Gerente"),e(),i(44,"option",26),o(45,"Supervisor"),e(),i(46,"option",27),o(47,"Operador"),e()(),p(48,ie,2,0,"div",16),e()(),h(49,"div",12),e(),i(50,"div",1)(51,"div",28)(52,"button",29),p(53,oe,2,0)(54,re,1,0),e(),i(55,"button",30),g("click",function(){E(d);let n=_();return b(n.onCancel())}),o(56," Cancelar "),e()()()()}if(t&2){let d,r,n,m,l=_();f("formGroup",l.userForm),s(7),v((d=l.userForm.get("nombre"))!=null&&d.invalid&&((d=l.userForm.get("nombre"))!=null&&d.touched)?7:-1),s(6),v((r=l.userForm.get("apellido"))!=null&&r.invalid&&((r=l.userForm.get("apellido"))!=null&&r.touched)?13:-1),s(7),v((n=l.userForm.get("email"))!=null&&n.invalid&&((n=l.userForm.get("email"))!=null&&n.touched)?20:-1),s(8),F(l.empleados),s(20),v((m=l.userForm.get("rol"))!=null&&m.invalid&&((m=l.userForm.get("rol"))!=null&&m.touched)?48:-1),s(4),f("disabled",l.userForm.invalid||l.isLoading),s(),v(l.isLoading?53:54)}}var he=(()=>{let a=class a{constructor(r,n,m,l,J,K,Q){this.fb=r,this.router=n,this.route=m,this.usuarioService=l,this.empleadoService=J,this.toastr=K,this.cdr=Q,this.isLoading=!1,this.empleados=[]}ngOnInit(){this.userId=this.route.snapshot.params.id,this.initForm(),this.loadEmpleados(),this.loadUser()}initForm(){this.userForm=this.fb.group({email:["",[u.required,u.email]],nombre:["",[u.required,u.minLength(2)]],apellido:["",[u.required,u.minLength(2)]],rol:["",[u.required]],idEmpleado:[null]})}loadEmpleados(){this.empleadoService.getEmpleados().subscribe({next:r=>{this.empleados=r},error:r=>{console.error("Error al cargar empleados:",r),this.toastr.error("Error al cargar la lista de empleados","Error")}})}loadUser(){this.isLoading=!0,this.usuarioService.obtenerUsuario(this.userId).subscribe({next:r=>{let n=r.data;this.userForm.patchValue({email:n.email,nombre:n.nombre,apellido:n.apellido,rol:n.rol,idEmpleado:n.idEmpleado}),this.isLoading=!1,this.cdr.detectChanges()},error:r=>{console.error("Error al cargar usuario:",r),this.toastr.error("Error al cargar el usuario","Error"),this.isLoading=!1,this.cdr.detectChanges()}})}onSubmit(){this.userForm.valid&&(this.isLoading=!0,this.usuarioService.actualizarUsuario(this.userId,this.userForm.value).subscribe({next:r=>{this.toastr.success("Usuario actualizado exitosamente","\xC9xito",{timeOut:3e3,positionClass:"toast-top-right"}),this.router.navigate(["/dashboard/hrmdashboards/users/user-list"])},error:r=>{console.error("Error al actualizar usuario:",r),this.toastr.error("Error al actualizar usuario: "+(r.error?.message||"Error desconocido"),"Error",{timeOut:3e3,positionClass:"toast-top-right"}),this.isLoading=!1}}))}onCancel(){this.router.navigate(["/dashboard/hrmdashboards/users/user-list"])}};a.\u0275fac=function(n){return new(n||a)(c(z),c(L),c(N),c(B),c($),c(R),c(T))},a.\u0275cmp=C({type:a,selectors:[["app-edit-user"]],standalone:!0,features:[I],decls:10,vars:7,consts:[[3,"title","title2","class1","path"],[1,"row"],[1,"col-xl-12"],[1,"card","custom-card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"text-center"],[3,"formGroup"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"form-group","mb-3"],[1,"form-label"],["type","text","formControlName","nombre","placeholder","Ingrese el nombre",1,"form-control"],[1,"invalid-feedback"],["type","text","formControlName","apellido","placeholder","Ingrese el apellido",1,"form-control"],["type","email","formControlName","email","placeholder","usuario@ejemplo.com",1,"form-control"],["formControlName","idEmpleado",1,"form-control"],["value",""],[3,"value"],["formControlName","rol",1,"form-control"],["value","superadmin"],["value","admin"],["value","gerente"],["value","supervisor"],["value","operador"],[1,"col-12"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(n,m){n&1&&(h(0,"app-hr-dashboard-page-header",0),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),o(6,"Editar Informaci\xF3n del Usuario"),e()(),i(7,"div",6),p(8,X,4,0,"div",7)(9,ne,57,7,"form",8),e()()()()),n&2&&(x("btn btn-secondary"),f("title","Editar Usuario")("title2","Volver a Lista")("class1","")("path","/dashboard/hrmdashboards/users/user-list"),s(8),v(m.isLoading&&!m.userForm.value.email?8:9))},dependencies:[H,P,G,j,k,q,V,D,M,O,w,A],styles:[".invalid-feedback[_ngcontent-%COMP%]{display:block}.form-control.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#dc3545}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}"]});let t=a;return t})();export{he as EditUserComponent};
