import{a as Z}from"./chunk-XIOJDDMJ.js";import"./chunk-IORNA22M.js";import{c as K,n as X}from"./chunk-USSGZFX3.js";import{a as Q,b as U,c as W}from"./chunk-XG7TRELF.js";import"./chunk-2CYZEA6T.js";import{r as J}from"./chunk-3DATYCE5.js";import"./chunk-EMEDTLE5.js";import{c as j,e as g,g as D,h as G,m as V,n as z,p as R,q as B,u as H,w as $,y as Y}from"./chunk-XRHNCSTF.js";import{Ib as S,Kb as w,Lc as O,Mc as T,Qa as n,Ra as v,Wb as l,Wc as P,Xb as y,Yb as x,db as c,dc as M,id as k,jb as s,kd as q,la as L,lb as h,nb as N,od as A,wb as r,xb as t,yb as u}from"./chunk-AZAYKVK3.js";import"./chunk-REZWHGN7.js";function ee(o,d){if(o&1&&(r(0,"ng-option",31),l(1),t()),o&2){let m=d.$implicit;s("value",m),n(),y(m)}}function te(o,d){o&1&&(r(0,"div",32),l(1," El tipo es requerido "),t())}function oe(o,d){o&1&&(r(0,"div",32),l(1," La galera es requerida "),t())}function ie(o,d){o&1&&(r(0,"span"),l(1,"La cantidad es requerida"),t())}function re(o,d){o&1&&(r(0,"span"),l(1,"La cantidad debe ser mayor a 0"),t())}function ne(o,d){if(o&1&&(r(0,"div",32),c(1,ie,2,0,"span",33)(2,re,2,0,"span",33),t()),o&2){let m,a,i=w();n(),s("ngIf",(m=i.loteForm.get("cantidad"))==null||m.errors==null?null:m.errors.required),n(),s("ngIf",(a=i.loteForm.get("cantidad"))==null||a.errors==null?null:a.errors.min)}}function ae(o,d){if(o&1&&(r(0,"ng-option",31),l(1),t()),o&2){let m=d.$implicit;s("value",m),n(),y(m)}}function le(o,d){o&1&&(r(0,"div",32),l(1," La fecha de inicio es requerida "),t())}function de(o,d){o&1&&u(0,"span",34)}var Ce=(()=>{let d=class d{constructor(a,i,e,p,f){this.fb=a,this.lotesService=i,this.router=e,this.route=p,this.toastr=f,this.loading=!1,this.isEditing=!1,this.loteId=null,this.tiposLote=["Ponedoras","Engorde"],this.estadosLote=["Activo","Inactivo","Desalojado"],this.loteForm=this.fb.group({tipo:["",g.required],galera:["",g.required],cantidad:["",[g.required,g.min(1)]],fechaInicio:["",g.required],fechaFin:[""],estado:["Activo"],observaciones:[""]})}ngOnInit(){this.route.params.subscribe(a=>{a.id&&(this.isEditing=!0,this.loteId=+a.id,this.loadLote())})}loadLote(){this.loteId&&(this.loading=!0,this.lotesService.getLoteById(this.loteId).subscribe({next:a=>{let i=a.data;this.loteForm.patchValue({tipo:i.tipo,galera:i.galera,cantidad:i.cantidad,fechaInicio:i.fechaInicio,fechaFin:i.fechaFin,estado:i.estado,observaciones:i.observaciones}),this.loading=!1},error:a=>{console.error("Error al cargar lote:",a),this.toastr.error("Error al cargar el lote","Error"),this.loading=!1}}))}onSubmit(){if(this.loteForm.valid){this.loading=!0;let a=this.loteForm.value;this.isEditing&&this.loteId?this.lotesService.updateLote(this.loteId,a).subscribe({next:()=>{this.toastr.success("Lote actualizado exitosamente","\xC9xito"),this.router.navigate(["/dashboard/business-dashboard/lotes"]),this.loading=!1},error:i=>{console.error("Error al actualizar lote:",i),this.toastr.error("Error al actualizar el lote","Error"),this.loading=!1}}):this.lotesService.createLote(a).subscribe({next:()=>{this.toastr.success("Lote creado exitosamente","\xC9xito"),this.router.navigate(["/dashboard/business-dashboard/lotes"]),this.loading=!1},error:i=>{console.error("Error al crear lote:",i),this.toastr.error("Error al crear el lote","Error"),this.loading=!1}})}else this.markFormGroupTouched(),this.toastr.warning("Por favor, complete todos los campos requeridos","Advertencia")}onCancel(){this.router.navigate(["/dashboard/business-dashboard/lotes"])}markFormGroupTouched(){Object.keys(this.loteForm.controls).forEach(a=>{this.loteForm.get(a)?.markAsTouched()})}};d.\u0275fac=function(i){return new(i||d)(v($),v(Z),v(q),v(k),v(J))},d.\u0275cmp=L({type:d,selectors:[["app-new-lote"]],standalone:!0,features:[M],decls:62,vars:25,consts:[[3,"title","title2","class1","path"],[1,"row"],[1,"col-xl-12"],[1,"card","custom-card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"form-group","mb-3"],["for","tipo",1,"form-label"],["formControlName","tipo","placeholder","Seleccione el tipo",1,"form-control","p-0"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback d-block",4,"ngIf"],["for","galera",1,"form-label"],["type","text","formControlName","galera","placeholder","Ingrese el nombre de la galera",1,"form-control"],["for","cantidad",1,"form-label"],["type","number","formControlName","cantidad","placeholder","Cantidad de aves","min","1",1,"form-control"],["for","estado",1,"form-label"],["formControlName","estado","placeholder","Seleccione el estado",1,"form-control","p-0"],["for","fechaInicio",1,"form-label"],["type","date","formControlName","fechaInicio",1,"form-control"],["for","fechaFin",1,"form-label"],["type","date","formControlName","fechaFin",1,"form-control"],[1,"col-md-12"],["for","observaciones",1,"form-label"],["formControlName","observaciones","rows","4","placeholder","Observaciones adicionales",1,"form-control"],[1,"form-group","d-flex","gap-2","justify-content-end"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],[3,"value"],[1,"invalid-feedback","d-block"],[4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(i,e){if(i&1&&(u(0,"app-hr-dashboard-page-header",0),r(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),l(6,"Informaci\xF3n del Lote"),t()(),r(7,"div",6)(8,"form",7),S("ngSubmit",function(){return e.onSubmit()}),r(9,"div",1)(10,"div",8)(11,"div",9)(12,"label",10),l(13,"Tipo *"),t(),r(14,"ng-select",11),c(15,ee,2,2,"ng-option",12),t(),c(16,te,2,0,"div",13),t()(),r(17,"div",8)(18,"div",9)(19,"label",14),l(20,"Galera *"),t(),u(21,"input",15),c(22,oe,2,0,"div",13),t()()(),r(23,"div",1)(24,"div",8)(25,"div",9)(26,"label",16),l(27,"Cantidad *"),t(),u(28,"input",17),c(29,ne,3,2,"div",13),t()(),r(30,"div",8)(31,"div",9)(32,"label",18),l(33,"Estado *"),t(),r(34,"ng-select",19),c(35,ae,2,2,"ng-option",12),t()()()(),r(36,"div",1)(37,"div",8)(38,"div",9)(39,"label",20),l(40,"Fecha de Inicio *"),t(),u(41,"input",21),c(42,le,2,0,"div",13),t()(),r(43,"div",8)(44,"div",9)(45,"label",22),l(46,"Fecha de Fin"),t(),u(47,"input",23),t()()(),r(48,"div",1)(49,"div",24)(50,"div",9)(51,"label",25),l(52,"Observaciones"),t(),u(53,"textarea",26),t()()(),r(54,"div",1)(55,"div",24)(56,"div",27)(57,"button",28),S("click",function(){return e.onCancel()}),l(58," Cancelar "),t(),r(59,"button",29),c(60,de,1,0,"span",30),l(61),t()()()()()()()()()),i&2){let p,f,b,_,F,E,C,I;N("btn btn-secondary"),s("title",e.isEditing?"Editar Lote":"Agregar Lote")("title2","Volver a Lista")("class1","")("path","/dashboard/business-dashboard/lotes"),n(8),s("formGroup",e.loteForm),n(6),h("is-invalid",((p=e.loteForm.get("tipo"))==null?null:p.invalid)&&((p=e.loteForm.get("tipo"))==null?null:p.touched)),n(),s("ngForOf",e.tiposLote),n(),s("ngIf",((f=e.loteForm.get("tipo"))==null?null:f.invalid)&&((f=e.loteForm.get("tipo"))==null?null:f.touched)),n(5),h("is-invalid",((b=e.loteForm.get("galera"))==null?null:b.invalid)&&((b=e.loteForm.get("galera"))==null?null:b.touched)),n(),s("ngIf",((_=e.loteForm.get("galera"))==null?null:_.invalid)&&((_=e.loteForm.get("galera"))==null?null:_.touched)),n(6),h("is-invalid",((F=e.loteForm.get("cantidad"))==null?null:F.invalid)&&((F=e.loteForm.get("cantidad"))==null?null:F.touched)),n(),s("ngIf",((E=e.loteForm.get("cantidad"))==null?null:E.invalid)&&((E=e.loteForm.get("cantidad"))==null?null:E.touched)),n(6),s("ngForOf",e.estadosLote),n(6),h("is-invalid",((C=e.loteForm.get("fechaInicio"))==null?null:C.invalid)&&((C=e.loteForm.get("fechaInicio"))==null?null:C.touched)),n(),s("ngIf",((I=e.loteForm.get("fechaInicio"))==null?null:I.invalid)&&((I=e.loteForm.get("fechaInicio"))==null?null:I.touched)),n(15),s("disabled",e.loading),n(2),s("disabled",e.loading||e.loteForm.invalid),n(),s("ngIf",e.loading),n(),x(" ",e.isEditing?"Actualizar":"Crear"," Lote ")}},dependencies:[P,O,T,X,K,W,U,Q,A,Y,V,j,z,D,G,H,R,B],styles:[".form-control[_ngcontent-%COMP%]{border-radius:.375rem;border:1px solid #ced4da}.form-control[_ngcontent-%COMP%]:focus{border-color:#86b7fe;box-shadow:0 0 0 .25rem #0d6efd40}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.form-control.is-invalid[_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 .25rem #dc354540}.invalid-feedback[_ngcontent-%COMP%]{display:block;width:100%;margin-top:.25rem;font-size:.875rem;color:#dc3545}.btn[_ngcontent-%COMP%]{border-radius:.375rem;font-weight:500}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 .25rem .5rem #0000001a}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}.custom-card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013;border:1px solid rgba(0,0,0,.125)}"]});let o=d;return o})();export{Ce as NewLoteComponent};
