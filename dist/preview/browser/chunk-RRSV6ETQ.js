import{a as be}from"./chunk-XJJJK3FL.js";import"./chunk-USS2N3RB.js";import{c as se,n as ge}from"./chunk-44QSXYOT.js";import{a as ue,b as pe,c as ve}from"./chunk-S5Y45Y7X.js";import"./chunk-PLAIHBDU.js";import{r as me}from"./chunk-GNT7AIZA.js";import"./chunk-LAI4YRFV.js";import{N as ie,O as oe,P as re,Q as ne,R as ae,T as de,U as le,b as H,c as W,ca as ce,e as _,g as Q,h as $,m as J,n as X,p as K,q as Y,u as Z,w as ee,y as te}from"./chunk-I6FKYEZO.js";import{$b as B,Cb as F,Ib as y,Kb as b,Qa as n,Ra as g,Vb as A,Wb as i,Wc as R,Xb as S,Yb as f,ac as D,bc as j,db as h,dc as G,id as q,jb as p,kd as U,la as w,lb as I,nb as T,od as z,rb as C,tb as V,ua as x,ub as L,va as E,vb as M,wb as e,xb as t,yb as m,yc as O}from"./chunk-W3KPMJ6O.js";import"./chunk-REZWHGN7.js";function fe(a,c){a&1&&(e(0,"div",35)(1,"div",37)(2,"span",38),i(3,"Cargando..."),t()()())}function _e(a,c){if(a&1&&(e(0,"div",46),i(1),t()),a&2){let d=b(3);n(),f(" ",d.getFieldError("nombre")," ")}}function xe(a,c){if(a&1&&(e(0,"ng-option",49),i(1),t()),a&2){let d=c.$implicit;p("value",d),n(),S(d)}}function Ee(a,c){if(a&1&&(e(0,"div",54),i(1),t()),a&2){let d=b(3);n(),f(" ",d.getFieldError("precio")," ")}}function Ce(a,c){if(a&1&&(e(0,"div",46),i(1),t()),a&2){let d=b(3);n(),f(" ",d.getFieldError("stock")," ")}}function Se(a,c){if(a&1){let d=F();e(0,"form",39),y("ngSubmit",function(){x(d);let o=b(2);return E(o.onSubmit())}),e(1,"h4",40),i(2,"Datos B\xE1sicos"),t(),e(3,"div",41)(4,"div",2)(5,"div",42)(6,"label",43),i(7,"Nombre del Producto *"),t()(),e(8,"div",44),m(9,"input",45),h(10,_e,2,1,"div",46),t()()(),e(11,"div",41)(12,"div",2)(13,"div",42)(14,"label",43),i(15,"Tama\xF1o"),t()(),e(16,"div",44),m(17,"input",47),t()()(),e(18,"div",41)(19,"div",2)(20,"div",42)(21,"label",43),i(22,"Categor\xEDa"),t()(),e(23,"div",44)(24,"ng-select",48),L(25,xe,2,2,"ng-option",49,V),t()()()(),e(27,"h4",50),i(28,"Precio e Inventario"),t(),e(29,"div",41)(30,"div",2)(31,"div",42)(32,"label",43),i(33,"Precio Unitario *"),t()(),e(34,"div",44)(35,"div",51)(36,"span",52),i(37,"Q"),t(),m(38,"input",53),t(),h(39,Ee,2,1,"div",54),t()()(),e(40,"div",41)(41,"div",2)(42,"div",42)(43,"label",43),i(44,"Stock Actual *"),t()(),e(45,"div",44),m(46,"input",55),h(47,Ce,2,1,"div",46),e(48,"small",56),i(49,'Use la opci\xF3n "Actualizar Stock" para modificar el inventario'),t()()()(),e(50,"div",57)(51,"div",2)(52,"div",42)(53,"label",58),i(54,"Estado del Producto:"),t()(),e(55,"div",44)(56,"div",59),m(57,"input",60),e(58,"label",61),i(59,"Activo/Inactivo"),t()()()()()()}if(a&2){let d=b(2);p("formGroup",d.productoForm),n(9),I("is-invalid",d.isFieldInvalid("nombre")),n(),C(d.isFieldInvalid("nombre")?10:-1),n(14),p("clearable",!0),n(),M(d.categorias),n(13),I("is-invalid",d.isFieldInvalid("precio")),n(),C(d.isFieldInvalid("precio")?39:-1),n(7),I("is-invalid",d.isFieldInvalid("stock")),n(),C(d.isFieldInvalid("stock")?47:-1)}}function Ie(a,c){if(a&1&&(e(0,"div",33)(1,"div",34),h(2,fe,4,0,"div",35)(3,Se,60,11,"form",36),t()()),a&2){let d=b();n(2),C(d.isLoading?2:3)}}var Ge=(()=>{let c=class c{constructor(r,o,l,s,v,u){this.fb=r,this.productosService=o,this.route=l,this.router=s,this.cdr=v,this.toastr=u,this.isLoading=!1,this.categorias=[],this.active=1,this.productoId=parseInt(this.route.snapshot.paramMap.get("id")||"0"),this.productoForm=this.fb.group({nombre:["",[_.required]],precio:["",[_.required,_.min(.01)]],stock:["",[_.required,_.min(0)]],categoria:[""],tamanio:[""],activo:[!0]})}ngOnInit(){this.loadProducto(),this.loadCategorias()}loadProducto(){this.isLoading=!0,this.productosService.getProductoById(this.productoId).subscribe({next:r=>{let o=r.data;this.productoForm.patchValue({nombre:o.nombre,precio:o.precio,stock:o.stock,categoria:o.categoria||"",tamanio:o.tamanio||"",activo:o.activo}),this.isLoading=!1,this.cdr.detectChanges()},error:r=>{this.toastr.error("Error al cargar producto","Error",{progressBar:!0,closeButton:!0}),this.isLoading=!1,this.cdr.detectChanges(),this.router.navigate(["../list"],{relativeTo:this.route})}})}loadCategorias(){this.productosService.getCategorias().subscribe({next:r=>{this.categorias=Array.isArray(r.data)?r.data.map(o=>o.categoria):[],this.cdr.detectChanges()},error:r=>{console.error("Error al cargar categor\xEDas:",r),this.categorias=[]}})}onSubmit(){if(this.productoForm.valid){this.isLoading=!0;let r=this.productoForm.value,o={nombre:r.nombre,precio:parseFloat(r.precio),categoria:r.categoria||void 0,tamanio:r.tamanio||void 0,activo:r.activo};this.productosService.updateProducto(this.productoId,o).subscribe({next:l=>{this.isLoading=!1,this.cdr.detectChanges(),this.toastr.success("Producto actualizado exitosamente","\xC9xito",{progressBar:!0,closeButton:!0}),setTimeout(()=>{this.router.navigate(["../list"],{relativeTo:this.route})},1e3)},error:l=>{this.toastr.error("Error al actualizar producto","Error",{progressBar:!0,closeButton:!0}),this.isLoading=!1,this.cdr.detectChanges()}})}else this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.productoForm.controls).forEach(r=>{this.productoForm.get(r)?.markAsTouched()})}isFieldInvalid(r){let o=this.productoForm.get(r);return!!(o&&o.invalid&&(o.dirty||o.touched))}getFieldError(r){let o=this.productoForm.get(r);if(o?.errors){if(o.errors.required)return`${r} es requerido`;if(o.errors.min)return`${r} debe ser mayor a ${o.errors.min.min}`}return""}onCancel(){this.router.navigate(["/dashboard/production-dashboard/productos/list"])}};c.\u0275fac=function(o){return new(o||c)(g(ee),g(be),g(q),g(U),g(O),g(me))},c.\u0275cmp=w({type:c,selectors:[["app-edit-producto"]],standalone:!0,features:[G],decls:54,vars:12,consts:[["nav","ngbNav"],[3,"title"],[1,"row"],[1,"col-xxl-3","col-xl-4","col-md-12","col-lg-12"],[1,"card","box-widget","widget-user","custom-card"],[1,"card-body","text-center"],[1,"widget-user-image","mx-auto","text-center"],[1,"fas","fa-box","fa-5x","text-primary"],[1,"pro-user","mt-3"],[1,"pro-user-username","text-dark","mb-1","fs-16"],[1,"pro-user-desc","text-muted","fs-12"],[1,"card-footer","p-0"],[1,"col-4","text-center","py-3","border-end"],[1,"fs-12","fw-semibold","mb-3"],[1,"mb-2"],[1,"fs-18","text-success"],[1,"fs-12","mb-0"],[1,"col-4","py-3","text-center","border-end"],[1,"fs-18","text-primary"],[1,"col-4","text-center","py-3"],[1,"fs-18"],[1,"col-xxl-9","col-xl-8","col-md-12","col-lg-12"],[1,"tab-menu-heading","hremp-tabs","p-0","border-0"],[1,"tabs-menu1"],["ngbNav","",1,"panel-tabs",3,"activeIdChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"panel-body","tabs-menu-body","hremp-tabs1","p-0"],[1,"tab-content",3,"ngbNavOutlet"],[1,"panel-footer","text-end"],["type","button",1,"me-2","btn","btn-primary",3,"click","disabled"],["type","button",1,"btn","btn-danger",3,"click"],["id","tab1"],[1,"card-body"],[1,"text-center"],[3,"formGroup"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[3,"ngSubmit","formGroup"],[1,"mb-4","font-weight-bold"],[1,"form-group"],[1,"col-md-3"],[1,"form-label","mb-0","mt-2"],[1,"col-md-9"],["type","text","formControlName","nombre","placeholder","Ingrese el nombre del producto",1,"form-control"],[1,"invalid-feedback"],["type","text","formControlName","tamanio","placeholder","Ej: XL, Jumbo, Grande",1,"form-control"],["formControlName","categoria","placeholder","Seleccionar categor\xEDa",1,"form-control","custom-select","p-0",3,"clearable"],[3,"value"],[1,"mb-4","mt-7","font-weight-bold"],[1,"input-group"],[1,"input-group-text"],["type","number","formControlName","precio","placeholder","0.00","step","0.01","min","0.01",1,"form-control"],[1,"invalid-feedback","d-block"],["type","number","formControlName","stock","placeholder","0","min","0","readonly","",1,"form-control"],[1,"text-muted"],[1,"form-group","mt-7"],[1,"form-label"],[1,"form-check","form-check-md","form-switch"],["type","checkbox","formControlName","activo","role","switch","id","switch-activo",1,"form-check-input"],["for","switch-activo",1,"form-check-label","mt-0","custom-switch-description"]],template:function(o,l){if(o&1){let s=F();m(0,"app-hr-dashboard-page-header",1),e(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6),m(6,"i",7),t(),e(7,"div",8)(8,"h5",9),i(9),t(),e(10,"h6",10),i(11),t()()(),e(12,"div",11)(13,"div",2)(14,"div",12)(15,"h5",13),i(16,"Precio"),t(),e(17,"h5",14)(18,"span",15),i(19),t()(),e(20,"h5",16),i(21,"Unitario"),t()(),e(22,"div",17)(23,"h5",13),i(24,"Stock"),t(),e(25,"h5",14)(26,"span",18),i(27),t()(),e(28,"h5",16),i(29,"Unidades"),t()(),e(30,"div",19)(31,"h5",13),i(32,"Estado"),t(),e(33,"h5",14)(34,"span",20),i(35),t()(),e(36,"h5",16),i(37,"Producto"),t()()()()()(),e(38,"div",21)(39,"div",22)(40,"div",23)(41,"ul",24,0),j("activeIdChange",function(u){return x(s),D(l.active,u)||(l.active=u),E(u)}),e(43,"li",25)(44,"a",26),i(45,"Informaci\xF3n del Producto"),t(),h(46,Ie,4,1,"ng-template",27),t()()()(),e(47,"div",28),m(48,"div",29),e(49,"div",30)(50,"button",31),y("click",function(){return x(s),E(l.onSubmit())}),i(51," Actualizar "),t(),e(52,"button",32),y("click",function(){return x(s),E(l.onCancel())}),i(53," Cancelar "),t()()()()()}if(o&2){let s,v,u,N,k,P,he=A(42);p("title","Editar Producto"),n(9),S(((s=l.productoForm.get("nombre"))==null?null:s.value)||"Editar Producto"),n(2),S(((v=l.productoForm.get("categoria"))==null?null:v.value)||"Sin categor\xEDa"),n(8),f("Q",((u=l.productoForm.get("precio"))==null?null:u.value)||"0.00",""),n(8),S(((N=l.productoForm.get("stock"))==null?null:N.value)||"0"),n(7),T((k=l.productoForm.get("activo"))!=null&&k.value?"text-success":"text-danger"),n(),f(" ",(P=l.productoForm.get("activo"))!=null&&P.value?"Activo":"Inactivo"," "),n(6),B("activeId",l.active),n(2),p("ngbNavItem",1),n(5),p("ngbNavOutlet",he),n(2),p("disabled",l.productoForm.invalid||l.isLoading)}},dependencies:[R,z,te,J,W,X,H,Q,$,Z,K,Y,ve,pe,ue,ce,ie,ne,re,oe,de,ae,le,ge,se],encapsulation:2});let a=c;return a})();export{Ge as EditProductoComponent};
