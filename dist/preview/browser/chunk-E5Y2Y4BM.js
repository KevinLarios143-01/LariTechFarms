import{a as fe}from"./chunk-7JSPO77L.js";import"./chunk-IORNA22M.js";import{c as ue,n as he}from"./chunk-L3BSSDS5.js";import{a as pe,b as ve,c as ge}from"./chunk-S5Y45Y7X.js";import"./chunk-TZ522SJ7.js";import{r as me}from"./chunk-P6RHK3TE.js";import"./chunk-LAI4YRFV.js";import{N as oe,O as re,P as ne,Q as ae,R as de,T as le,U as ce,b as W,c as H,ca as se,e as x,g as J,h as X,m as K,n as Q,p as Y,q as Z,u as ee,w as te,y as ie}from"./chunk-I6FKYEZO.js";import{$b as D,Cb as N,Ib as y,Kb as g,Qa as n,Ra as v,Vb as V,Wb as o,Wc as O,Xb as E,Yb as h,ac as A,bc as G,db as b,dc as j,id as q,jb as s,kd as z,la as P,lb as I,ld as U,nb as T,od as $,rb as _,tb as M,ua as C,ub as B,va as S,vb as L,wb as e,xb as t,yb as m,yc as R}from"./chunk-W3KPMJ6O.js";import"./chunk-REZWHGN7.js";function _e(a,c){a&1&&(e(0,"div",35)(1,"div",37)(2,"span",38),o(3,"Cargando..."),t()()())}function xe(a,c){if(a&1&&(e(0,"div",46),o(1),t()),a&2){let d=g(3);n(),h(" ",d.getFieldError("nombre")," ")}}function Ee(a,c){if(a&1&&(e(0,"ng-option",49),o(1),t()),a&2){let d=c.$implicit;s("value",d),n(),E(d)}}function Ce(a,c){if(a&1&&(e(0,"div",54),o(1),t()),a&2){let d=g(3);n(),h(" ",d.getFieldError("precio")," ")}}function Se(a,c){if(a&1&&(e(0,"div",46),o(1),t()),a&2){let d=g(3);n(),h(" ",d.getFieldError("stock")," ")}}function Ie(a,c){a&1&&(e(0,"small",56),o(1,'Use la opci\xF3n "Actualizar Stock" para modificar el inventario'),t())}function Ne(a,c){if(a&1){let d=N();e(0,"form",39),y("ngSubmit",function(){C(d);let r=g(2);return S(r.onSubmit())}),e(1,"h4",40),o(2,"Datos B\xE1sicos"),t(),e(3,"div",41)(4,"div",2)(5,"div",42)(6,"label",43),o(7,"Nombre del Producto *"),t()(),e(8,"div",44),m(9,"input",45),b(10,xe,2,1,"div",46),t()()(),e(11,"div",41)(12,"div",2)(13,"div",42)(14,"label",43),o(15,"Tama\xF1o"),t()(),e(16,"div",44),m(17,"input",47),t()()(),e(18,"div",41)(19,"div",2)(20,"div",42)(21,"label",43),o(22,"Categor\xEDa"),t()(),e(23,"div",44)(24,"ng-select",48),B(25,Ee,2,2,"ng-option",49,M),t()()()(),e(27,"h4",50),o(28,"Precio e Inventario"),t(),e(29,"div",41)(30,"div",2)(31,"div",42)(32,"label",43),o(33,"Precio Unitario *"),t()(),e(34,"div",44)(35,"div",51)(36,"span",52),o(37,"$"),t(),m(38,"input",53),t(),b(39,Ce,2,1,"div",54),t()()(),e(40,"div",41)(41,"div",2)(42,"div",42)(43,"label",43),o(44,"Stock Inicial *"),t()(),e(45,"div",44),m(46,"input",55),b(47,Se,2,1,"div",46)(48,Ie,2,0,"small",56),t()()(),e(49,"div",57)(50,"div",2)(51,"div",42)(52,"label",58),o(53,"Estado del Producto:"),t()(),e(54,"div",44)(55,"div",59),m(56,"input",60),e(57,"label",61),o(58,"Activo/Inactivo"),t()()()()()()}if(a&2){let d=g(2);s("formGroup",d.productoForm),n(9),I("is-invalid",d.isFieldInvalid("nombre")),n(),_(d.isFieldInvalid("nombre")?10:-1),n(14),s("clearable",!0),n(),L(d.categorias),n(13),I("is-invalid",d.isFieldInvalid("precio")),n(),_(d.isFieldInvalid("precio")?39:-1),n(7),I("is-invalid",d.isFieldInvalid("stock")),s("readonly",d.isEditMode),n(),_(d.isFieldInvalid("stock")?47:-1),n(),_(d.isEditMode?48:-1)}}function ye(a,c){if(a&1&&(e(0,"div",33)(1,"div",34),b(2,_e,4,0,"div",35)(3,Ne,59,13,"form",36),t()()),a&2){let d=g();n(2),_(d.isLoading?2:3)}}var Oe=(()=>{let c=class c{constructor(i,r,l,p,f,u){this.fb=i,this.productosService=r,this.route=l,this.router=p,this.cdr=f,this.toastr=u,this.categorias=[],this.isLoading=!1,this.isEditMode=!1,this.productoId=null,this.active=1,this.productoForm=this.fb.group({nombre:["",x.required],tamanio:[""],precio:["",[x.required,x.min(.01)]],stock:["",[x.required,x.min(0)]],categoria:[""],activo:[!0]})}ngOnInit(){this.loadCategorias(),this.checkEditMode()}checkEditMode(){let i=this.route.snapshot.paramMap.get("id");i&&(this.isEditMode=!0,this.productoId=parseInt(i),this.loadProducto())}loadCategorias(){this.productosService.getCategorias().subscribe({next:i=>{this.categorias=i.data,this.cdr.detectChanges()},error:i=>{console.error("Error al cargar categor\xEDas:",i)}})}loadProducto(){this.productoId&&(this.isLoading=!0,this.productosService.getProductoById(this.productoId).subscribe({next:i=>{let r=i.data;this.productoForm.patchValue({nombre:r.nombre,tamanio:r.tamanio||"",precio:r.precio,stock:r.stock,categoria:r.categoria||"",activo:r.activo}),this.isLoading=!1,this.cdr.detectChanges()},error:i=>{this.toastr.error("Error al cargar producto","Error",{progressBar:!0,closeButton:!0}),this.isLoading=!1,this.router.navigate(["../list"],{relativeTo:this.route})}}))}onSubmit(){if(this.productoForm.valid){this.isLoading=!0;let i=this.productoForm.value;if(this.isEditMode&&this.productoId){let r={nombre:i.nombre,tamanio:i.tamanio||void 0,precio:parseFloat(i.precio),categoria:i.categoria||void 0,activo:i.activo};this.productosService.updateProducto(this.productoId,r).subscribe({next:l=>{this.toastr.success("Producto actualizado exitosamente","\xC9xito",{progressBar:!0,closeButton:!0}),this.router.navigate(["../list"],{relativeTo:this.route})},error:l=>{this.toastr.error("Error al actualizar producto","Error",{progressBar:!0,closeButton:!0}),this.isLoading=!1,this.cdr.detectChanges()}})}else{let r={nombre:i.nombre,tamanio:i.tamanio||void 0,precio:parseFloat(i.precio),stock:parseInt(i.stock),categoria:i.categoria||void 0,activo:i.activo};this.productosService.createProducto(r).subscribe({next:l=>{this.toastr.success("Producto creado exitosamente","\xC9xito",{progressBar:!0,closeButton:!0}),this.router.navigate(["../list"],{relativeTo:this.route})},error:l=>{this.toastr.error("Error al crear producto","Error",{progressBar:!0,closeButton:!0}),this.isLoading=!1,this.cdr.detectChanges()}})}}else this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.productoForm.controls).forEach(i=>{this.productoForm.get(i)?.markAsTouched()})}isFieldInvalid(i){let r=this.productoForm.get(i);return!!(r&&r.invalid&&(r.dirty||r.touched))}getFieldError(i){let r=this.productoForm.get(i);if(r?.errors){if(r.errors.required)return`${i} es requerido`;if(r.errors.min)return`${i} debe ser mayor a ${r.errors.min.min}`}return""}};c.\u0275fac=function(r){return new(r||c)(v(te),v(fe),v(q),v(z),v(R),v(me))},c.\u0275cmp=P({type:c,selectors:[["app-new-producto"]],standalone:!0,features:[j],decls:54,vars:13,consts:[["nav","ngbNav"],[3,"title"],[1,"row"],[1,"col-xxl-3","col-xl-4","col-md-12","col-lg-12"],[1,"card","box-widget","widget-user","custom-card"],[1,"card-body","text-center"],[1,"widget-user-image","mx-auto","text-center"],[1,"fas","fa-box","fa-5x","text-primary"],[1,"pro-user","mt-3"],[1,"pro-user-username","text-dark","mb-1","fs-16"],[1,"pro-user-desc","text-muted","fs-12"],[1,"card-footer","p-0"],[1,"col-4","text-center","py-3","border-end"],[1,"fs-12","fw-semibold","mb-3"],[1,"mb-2"],[1,"fs-18","text-success"],[1,"fs-12","mb-0"],[1,"col-4","py-3","text-center","border-end"],[1,"fs-18","text-primary"],[1,"col-4","text-center","py-3"],[1,"fs-18"],[1,"col-xxl-9","col-xl-8","col-md-12","col-lg-12"],[1,"tab-menu-heading","hremp-tabs","p-0","border-0"],[1,"tabs-menu1"],["ngbNav","",1,"panel-tabs",3,"activeIdChange","activeId"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"panel-body","tabs-menu-body","hremp-tabs1","p-0"],[1,"tab-content",3,"ngbNavOutlet"],[1,"panel-footer","text-end"],["type","button",1,"me-2","btn","btn-primary",3,"click","disabled"],["type","button","routerLink","../list",1,"btn","btn-danger"],["id","tab1"],[1,"card-body"],[1,"text-center"],[3,"formGroup"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[3,"ngSubmit","formGroup"],[1,"mb-4","font-weight-bold"],[1,"form-group"],[1,"col-md-3"],[1,"form-label","mb-0","mt-2"],[1,"col-md-9"],["type","text","formControlName","nombre","placeholder","Ingrese el nombre del producto",1,"form-control"],[1,"invalid-feedback"],["type","text","formControlName","tamanio","placeholder","Ej: XL, Jumbo, Grande",1,"form-control"],["formControlName","categoria","placeholder","Seleccionar categor\xEDa",1,"form-control","custom-select","p-0",3,"clearable"],[3,"value"],[1,"mb-4","mt-7","font-weight-bold"],[1,"input-group"],[1,"input-group-text"],["type","number","formControlName","precio","placeholder","0.00","step","0.01","min","0.01",1,"form-control"],[1,"invalid-feedback","d-block"],["type","number","formControlName","stock","placeholder","0","min","0",1,"form-control",3,"readonly"],[1,"text-muted"],[1,"form-group","mt-7"],[1,"form-label"],[1,"form-check","form-check-md","form-switch"],["type","checkbox","formControlName","activo","role","switch","id","switch-activo",1,"form-check-input"],["for","switch-activo",1,"form-check-label","mt-0","custom-switch-description"]],template:function(r,l){if(r&1){let p=N();m(0,"app-hr-dashboard-page-header",1),e(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6),m(6,"i",7),t(),e(7,"div",8)(8,"h5",9),o(9),t(),e(10,"h6",10),o(11),t()()(),e(12,"div",11)(13,"div",2)(14,"div",12)(15,"h5",13),o(16,"Precio"),t(),e(17,"h5",14)(18,"span",15),o(19),t()(),e(20,"h5",16),o(21,"Unitario"),t()(),e(22,"div",17)(23,"h5",13),o(24,"Stock"),t(),e(25,"h5",14)(26,"span",18),o(27),t()(),e(28,"h5",16),o(29,"Unidades"),t()(),e(30,"div",19)(31,"h5",13),o(32,"Estado"),t(),e(33,"h5",14)(34,"span",20),o(35),t()(),e(36,"h5",16),o(37,"Producto"),t()()()()()(),e(38,"div",21)(39,"div",22)(40,"div",23)(41,"ul",24,0),G("activeIdChange",function(u){return C(p),A(l.active,u)||(l.active=u),S(u)}),e(43,"li",25)(44,"a",26),o(45,"Informaci\xF3n del Producto"),t(),b(46,ye,4,1,"ng-template",27),t()()()(),e(47,"div",28),m(48,"div",29),e(49,"div",30)(50,"button",31),y("click",function(){return C(p),S(l.onSubmit())}),o(51),t(),e(52,"button",32),o(53," Cancelar "),t()()()()()}if(r&2){let p,f,u,F,k,w,be=V(42);s("title",l.isEditMode?"Editar Producto":"Agregar Producto"),n(9),E(((p=l.productoForm.get("nombre"))==null?null:p.value)||"Nuevo Producto"),n(2),E(((f=l.productoForm.get("categoria"))==null?null:f.value)||"Sin categor\xEDa"),n(8),h("$",((u=l.productoForm.get("precio"))==null?null:u.value)||"0.00",""),n(8),E(((F=l.productoForm.get("stock"))==null?null:F.value)||"0"),n(7),T((k=l.productoForm.get("activo"))!=null&&k.value?"text-success":"text-danger"),n(),h(" ",(w=l.productoForm.get("activo"))!=null&&w.value?"Activo":"Inactivo"," "),n(6),D("activeId",l.active),n(2),s("ngbNavItem",1),n(5),s("ngbNavOutlet",be),n(2),s("disabled",l.productoForm.invalid||l.isLoading),n(),h(" ",l.isEditMode?"Actualizar":"Guardar"," ")}},dependencies:[O,$,U,ie,K,H,Q,W,J,X,ee,Y,Z,ge,ve,pe,se,oe,ae,ne,re,le,de,ce,he,ue]});let a=c;return a})();export{Oe as NewProductoComponent};
