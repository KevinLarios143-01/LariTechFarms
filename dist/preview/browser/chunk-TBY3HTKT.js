import{a as X}from"./chunk-DKVPDNA5.js";import{a as Q}from"./chunk-5NXGHONX.js";import"./chunk-USS2N3RB.js";import{c as G,n as K}from"./chunk-FYZLZUO4.js";import{a as Z,b as z,c as J}from"./chunk-KAKXLQQZ.js";import"./chunk-Q4N2GC3M.js";import{r as q}from"./chunk-GNT7AIZA.js";import"./chunk-27TGOTIH.js";import{c as R,g as j,l as V,x as U}from"./chunk-BJ65GJZA.js";import{$b as f,Cb as M,Ib as g,Kb as S,Lc as A,Mc as W,Qa as o,Qc as D,Ra as C,Wb as r,Wc as O,Xb as h,Yb as L,Zb as w,ac as v,bc as _,db as y,dc as H,fc as x,jb as p,la as E,ld as N,nb as b,nc as I,od as P,qc as B,ua as T,va as F,wb as t,xb as i,yb as u,yc as k}from"./chunk-W3KPMJ6O.js";import"./chunk-REZWHGN7.js";var Y=l=>["../view",l],$=l=>["../edit",l];function ee(l,c){if(l&1&&(t(0,"ng-option",34),r(1),i()),l&2){let a=c.$implicit;p("value",a.id.toString()),o(),h(a.galera)}}function te(l,c){if(l&1&&(t(0,"ng-option",34),r(1),i()),l&2){let a=c.$implicit;p("value",a),o(),h(a)}}function ie(l,c){l&1&&(t(0,"div",35)(1,"div",36)(2,"span",37),r(3,"Cargando..."),i()()())}function ne(l,c){l&1&&(t(0,"tr")(1,"td",42)(2,"div",43),u(3,"i",44),t(4,"p"),r(5,"No hay controles disponibles"),i()()()())}function re(l,c){if(l&1){let a=M();t(0,"tr")(1,"td"),r(2),i(),t(3,"td"),r(4),I(5,"date"),i(),t(6,"td")(7,"div",25)(8,"span",45),u(9,"i",46),i(),t(10,"div")(11,"h6",47),r(12),i(),t(13,"span",48),r(14),i()()()(),t(15,"td",49),r(16),i(),t(17,"td")(18,"span",50),r(19),i()(),t(20,"td"),r(21),i(),t(22,"td")(23,"div",51)(24,"a",52),u(25,"i",53),i(),t(26,"a",54),u(27,"i",55),i(),t(28,"a",56),g("click",function(){let d=T(a).$implicit,n=S(2);return F(n.deleteControl(d.id))}),u(29,"i",57),i()()()()}if(l&2){let a=c.$implicit,e=S(2);o(2),L("#CH-",a.id.toString().padStart(3,"0"),""),o(2),h(B(5,12,a.fecha,"dd/MM/yyyy","UTC")),o(8),h(a.lote==null?null:a.lote.galera),o(2),h(a.lote==null?null:a.lote.tipo),o(2),h(a.cantidadHuevos),o(2),b("bg-"+e.getCalidadBadgeColor(a.calidad)+"-transparent"),o(),L(" ",a.calidad||"Sin especificar"," "),o(2),w("",a.usuario==null?null:a.usuario.nombre," ",a.usuario==null?null:a.usuario.apellido,""),o(3),p("routerLink",x(16,Y,a.id)),o(2),p("routerLink",x(18,$,a.id))}}function ae(l,c){if(l&1&&(t(0,"div",38)(1,"table",39)(2,"thead")(3,"tr")(4,"th"),r(5,"#ID"),i(),t(6,"th"),r(7,"Fecha"),i(),t(8,"th"),r(9,"Lote/Galera"),i(),t(10,"th"),r(11,"Cantidad Huevos"),i(),t(12,"th"),r(13,"Calidad"),i(),t(14,"th"),r(15,"Usuario"),i(),t(16,"th"),r(17,"Acciones"),i()()(),t(18,"tbody"),y(19,ne,6,0,"tr",40)(20,re,30,20,"tr",41),i()()()),l&2){let a=S();o(19),p("ngIf",a.filteredControles.length===0),o(),p("ngForOf",a.filteredControles)("ngForTrackBy",a.trackByControlId)}}var ye=(()=>{let c=class c{constructor(e,d,n,m){this.huevosService=e,this.lotesService=d,this.cdr=n,this.toastr=m,this.controles=[],this.filteredControles=[],this.lotes=[],this.isLoading=!1,this.searchTerm="",this.selectedLote="",this.selectedCalidad="",this.selectedFecha="",this.calidades=["Excelente","Buena","Regular","Mala"]}ngOnInit(){this.loadControles(),this.loadLotes()}loadControles(){this.isLoading=!0,this.huevosService.getControles().subscribe({next:e=>{e?.data?.data&&Array.isArray(e.data.data)?this.controles=e.data.data:e?.data?.items&&Array.isArray(e.data.items)?this.controles=e.data.items:e?.data&&Array.isArray(e.data)?this.controles=e.data:Array.isArray(e)?this.controles=e:this.controles=[],this.filteredControles=[...this.controles],this.isLoading=!1,this.cdr.detectChanges()},error:e=>{this.controles=[],this.filteredControles=[],this.toastr.error("Error al cargar controles de huevos","Error",{progressBar:!0,closeButton:!0}),this.isLoading=!1,this.cdr.detectChanges()}})}loadLotes(){this.lotesService.getLotes().subscribe({next:e=>{let d=[];e?.data?.data&&Array.isArray(e.data.data)?d=e.data.data:e?.data?.items&&Array.isArray(e.data.items)?d=e.data.items:e?.data&&Array.isArray(e.data)?d=e.data:Array.isArray(e)&&(d=e),this.lotes=d.filter(n=>n.tipo==="Ponedoras"&&n.estado==="Activo"),this.cdr.detectChanges()},error:e=>{this.lotes=[],console.error("Error al cargar lotes:",e)}})}applyFilters(){this.filteredControles=this.controles.filter(e=>{let d=!this.searchTerm||e.lote?.galera.toLowerCase().includes(this.searchTerm.toLowerCase())||e.usuario?.nombre.toLowerCase().includes(this.searchTerm.toLowerCase())||e.usuario?.apellido.toLowerCase().includes(this.searchTerm.toLowerCase()),n=!this.selectedLote||e.idLote.toString()===this.selectedLote,m=!this.selectedCalidad||e.calidad===this.selectedCalidad,s=!this.selectedFecha||new Date(e.fecha).toDateString()===new Date(this.selectedFecha).toDateString();return d&&n&&m&&s}),this.cdr.detectChanges()}deleteControl(e){confirm("\xBFEst\xE1 seguro de eliminar este control?")&&this.huevosService.deleteControl(e).subscribe({next:()=>{this.toastr.success("Control eliminado exitosamente","\xC9xito",{progressBar:!0,closeButton:!0}),this.loadControles()},error:()=>{this.toastr.error("Error al eliminar control","Error",{progressBar:!0,closeButton:!0})}})}formatDateForInput(e){return e?new Date(e+"T00:00:00.000Z").toISOString().split("T")[0]:""}getCalidadClass(e){switch(e){case"Excelente":return"text-success";case"Buena":return"text-info";case"Regular":return"text-warning";case"Mala":return"text-danger";default:return"text-muted"}}getCalidadBadgeColor(e){switch(e){case"Excelente":return"success";case"Buena":return"info";case"Regular":return"warning";case"Mala":return"danger";default:return"secondary"}}clearFilters(){this.searchTerm="",this.selectedLote="",this.selectedCalidad="",this.selectedFecha="",this.filteredControles=[...this.controles],this.cdr.detectChanges()}trackByControlId(e,d){return d.id}trackByLoteId(e,d){return d.id}};c.\u0275fac=function(d){return new(d||c)(C(X),C(Q),C(k),C(q))},c.\u0275cmp=E({type:c,selectors:[["app-huevo-list"]],standalone:!0,features:[H],decls:64,vars:18,consts:[[3,"title","title2","class1","path"],[1,"row"],[1,"col-xl-12","col-md-12","col-lg-12"],[1,"card","custom-card"],[1,"card-header","d-flex","justify-content-between","border-bottom-0"],[1,"card-title"],[1,"float-end"],["type","text","placeholder","buscar",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"card-body"],[1,"col-md-12","col-lg-7"],[1,"col-md-4"],[1,"form-group"],[1,"form-label"],["placeholder","Filtrar por lote",1,"form-control","p-0",3,"ngModelChange","change","ngModel","clearable"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["placeholder","Filtrar por calidad",1,"form-control","p-0",3,"ngModelChange","change","ngModel","clearable"],[3,"value",4,"ngFor","ngForOf"],["type","date","placeholder","Filtrar por fecha",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-md-2"],[1,"form-group","mt-2"],[1,"btn","btn-primary","d-grid",3,"click"],[1,"col-md-3"],[1,"btn","btn-outline-secondary","d-grid",3,"click"],[1,"card-body","border-top"],[1,"col-sm-6","mb-1"],[1,"d-flex","align-items-center"],[1,"d-flex","ms-2","mx-2"],["name","quantity","placeholder","10",1,"form-control","wd-150","p-0"],["value","10"],["value","25"],["value","50"],["value","100"],["class","text-center py-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],[3,"value"],[1,"text-center","py-4"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"table-responsive"],[1,"table","table-vcenter","text-nowrap","table-bordered","border-bottom"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["colspan","7",1,"text-center","py-4"],[1,"text-muted"],[1,"fe","fe-inbox","fs-24","mb-2"],[1,"avatar","avatar-md","me-2","avatar-rounded","bg-primary-transparent"],[1,"fe","fe-layers"],[1,"mb-1","fs-14"],[1,"fs-12","text-muted"],[1,"fw-bold","text-primary"],[1,"badge"],[1,"d-flex"],["placement","top","ngbTooltip","Ver Control",1,"action-btns1",3,"routerLink"],[1,"fe","fe-eye","text-primary"],["placement","top","ngbTooltip","Editar",1,"action-btns1",3,"routerLink"],[1,"fe","fe-edit-2","text-success"],["placement","top","ngbTooltip","Eliminar",1,"action-btns1",3,"click"],[1,"fe","fe-trash","text-danger"]],template:function(d,n){d&1&&(u(0,"app-hr-dashboard-page-header",0),t(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),r(6,"Resumen de Control de Huevos"),i(),t(7,"div",6)(8,"input",7),_("ngModelChange",function(s){return v(n.searchTerm,s)||(n.searchTerm=s),s}),g("input",function(){return n.applyFilters()}),i()()(),t(9,"div",8)(10,"div",1)(11,"div",9)(12,"div",1)(13,"div",10)(14,"div",11)(15,"label",12),r(16,"Lote:"),i(),t(17,"ng-select",13),_("ngModelChange",function(s){return v(n.selectedLote,s)||(n.selectedLote=s),s}),g("change",function(){return n.applyFilters()}),y(18,ee,2,2,"ng-option",14),i()()(),t(19,"div",10)(20,"div",11)(21,"label",12),r(22,"Calidad:"),i(),t(23,"ng-select",15),_("ngModelChange",function(s){return v(n.selectedCalidad,s)||(n.selectedCalidad=s),s}),g("change",function(){return n.applyFilters()}),y(24,te,2,2,"ng-option",16),i()()(),t(25,"div",10)(26,"div",11)(27,"label",12),r(28,"Fecha:"),i(),t(29,"input",17),_("ngModelChange",function(s){return v(n.selectedFecha,s)||(n.selectedFecha=s),s}),g("change",function(){return n.applyFilters()}),i()()()()(),t(30,"div",18)(31,"div",19),u(32,"label",12),t(33,"button",20),g("click",function(){return n.applyFilters()}),r(34,"Buscar"),i()()(),t(35,"div",21)(36,"div",19),u(37,"label",12),t(38,"button",22),g("click",function(){return n.clearFilters()}),r(39,"Limpiar"),i()()()()(),t(40,"div",23)(41,"div",1)(42,"div",24)(43,"div",25)(44,"span"),r(45,"Mostrar"),i(),t(46,"div",26)(47,"div",11)(48,"ng-select",27)(49,"ng-option",28),r(50,"10"),i(),t(51,"ng-option",29),r(52,"25"),i(),t(53,"ng-option",30),r(54,"50"),i(),t(55,"ng-option",31),r(56,"100"),i()()()(),t(57,"span"),r(58,"entradas"),i()()(),t(59,"div",24)(60,"div",6)(61,"input",7),_("ngModelChange",function(s){return v(n.searchTerm,s)||(n.searchTerm=s),s}),g("input",function(){return n.applyFilters()}),i()()()(),y(62,ie,4,0,"div",32)(63,ae,21,3,"div",33),i()()()()),d&2&&(b("btn btn-primary"),p("title","Control de Huevos")("title2","Nuevo Control")("class1","")("path","../new"),o(8),f("ngModel",n.searchTerm),o(9),f("ngModel",n.selectedLote),p("clearable",!0),o(),p("ngForOf",n.lotes)("ngForTrackBy",n.trackByLoteId),o(5),f("ngModel",n.selectedCalidad),p("clearable",!0),o(),p("ngForOf",n.calidades),o(5),f("ngModel",n.selectedFecha),o(32),f("ngModel",n.searchTerm),o(),p("ngIf",n.isLoading),o(),p("ngIf",!n.isLoading))},dependencies:[K,G,O,A,W,D,P,N,U,R,j,V,J,z,Z]});let l=c;return l})();export{ye as HuevoListComponent};
