<app-hr-dashboard-page-header [title]="isEditing ? 'Editar Control' : 'Nuevo Control'" [title2]="'Volver a Lista'" [class]="'btn btn-secondary'"
  [class1]="''" [path]="'/dashboard/production-dashboard/huevos'">
</app-hr-dashboard-page-header>

<div class="row">
  <div class="col-xl-12">
    <div class="card custom-card">
      <div class="card-header">
        <h3 class="card-title">Informaci√≥n del Control</h3>
      </div>
      <div class="card-body">
        <form [formGroup]="controlForm" (ngSubmit)="onSubmit()">
          <div class="row">
            <div class="col-md-6">
              <div class="form-group mb-3">
                <label class="form-label" for="idLote">Lote *</label>
                <ng-select class="form-control p-0" 
                           [class.is-invalid]="controlForm.get('idLote')?.invalid && controlForm.get('idLote')?.touched"
                           formControlName="idLote" placeholder="Seleccione el lote">
                  <ng-option *ngFor="let lote of lotes" [value]="lote.id">{{lote.galera}} - {{lote.tipo}}</ng-option>
                </ng-select>
                <div *ngIf="controlForm.get('idLote')?.invalid && controlForm.get('idLote')?.touched" class="invalid-feedback d-block">
                  El lote es requerido
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group mb-3">
                <label class="form-label" for="fecha">Fecha *</label>
                <input type="date" class="form-control" 
                       [class.is-invalid]="controlForm.get('fecha')?.invalid && controlForm.get('fecha')?.touched"
                       formControlName="fecha">
                <div *ngIf="controlForm.get('fecha')?.invalid && controlForm.get('fecha')?.touched" class="invalid-feedback d-block">
                  La fecha es requerida
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="form-group mb-3">
                <label class="form-label" for="cantidadHuevos">Cantidad de Huevos *</label>
                <input type="number" class="form-control" 
                       [class.is-invalid]="controlForm.get('cantidadHuevos')?.invalid && controlForm.get('cantidadHuevos')?.touched"
                       formControlName="cantidadHuevos" placeholder="Cantidad de huevos" min="1">
                <div *ngIf="controlForm.get('cantidadHuevos')?.invalid && controlForm.get('cantidadHuevos')?.touched" class="invalid-feedback d-block">
                  <span *ngIf="controlForm.get('cantidadHuevos')?.errors?.['required']">La cantidad es requerida</span>
                  <span *ngIf="controlForm.get('cantidadHuevos')?.errors?.['min']">La cantidad debe ser mayor a 0</span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group mb-3">
                <label class="form-label" for="calidad">Calidad</label>
                <ng-select class="form-control p-0" 
                           formControlName="calidad" placeholder="Seleccione la calidad">
                  <ng-option *ngFor="let calidad of calidades" [value]="calidad">{{calidad}}</ng-option>
                </ng-select>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12">
              <div class="form-group d-flex gap-2 justify-content-end">
                <button type="button" class="btn btn-secondary" (click)="onCancel()" [disabled]="loading">
                  Cancelar
                </button>
                <button type="submit" class="btn btn-primary" [disabled]="loading || controlForm.invalid">
                  <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status"></span>
                  {{isEditing ? 'Actualizar' : 'Crear'}} Control
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>